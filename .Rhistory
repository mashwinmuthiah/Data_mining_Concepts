# Removed ID
rawdataset <- rawdataset[,-1]
new.data <- rawdataset
new.data$LIMIT_BAL <- log(rawdataset$LIMIT_BAL)
# Applied log to LIMIT_BAL
par(mfcol=c(1,1))
par(mfcol=c(2,2))
plot(density(rawdataset$LIMIT_BAL))
plot(density(log(rawdataset$LIMIT_BAL)))
boxplot(log(rawdataset$LIMIT_BAL))
# Education groups
table(new.data$SEX)
table(new.data$EDUCATION)
aggregate(cbind(AGE, LIMIT_BAL) ~  EDUCATION, data=rawdataset, FUN=mean)
aggregate(cbind(AGE, LIMIT_BAL) ~ EDUCATION, data=rawdataset, FUN=median)
# Marriage
table(rawdataset$MARRIAGE)
aggregate(cbind(AGE, LIMIT_BAL) ~ MARRIAGE, data=rawdataset, FUN=mean)
aggregate(cbind(AGE, LIMIT_BAL) ~ default.payment.next.month + MARRIAGE, data=rawdataset, FUN=median)
# Repayment Status
plot(table(rawdataset$PAY_0, rawdataset$default.payment.next.month))
# Repayment Status
par(mfrows = c(1,1))
plot(table(rawdataset$PAY_0, rawdataset$default.payment.next.month))
# Repayment Status
par(mfrow = c(1,1))
plot(table(rawdataset$PAY_0, rawdataset$default.payment.next.month))
plot(table(rawdataset$PAY_6, rawdataset$default.payment.next.month))
# Applied log to LIMIT_BAL
par(mfcol=c(1,1))
par(mfcol=c(2,2))
plot(density(rawdataset$LIMIT_BAL))
plot(density(log(rawdataset$LIMIT_BAL)))
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogTrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogValidationSet.csv")
#change the numerical to factor
a_train$SEX<-as.factor(a_train$SEX)
a_train$EDUCATION<-as.factor(a_train$EDUCATION)
a_train$MARRIAGE<-as.factor(a_train$MARRIAGE)
a_valid$SEX<-as.factor(a_valid$SEX)
a_valid$EDUCATION<-as.factor(a_valid$EDUCATION)
a_valid$MARRIAGE<-as.factor(a_valid$MARRIAGE)
logit.class<-glm(default.payment.next.month ~LIMIT_BAL+AGE+PAY_0+PAY_2+PAY_3+
PAY_4+PAY_5+PAY_6+PAY_AMT1+PAY_AMT2+PAY_AMT3+PAY_AMT4+PAY_AMT5+
PAY_AMT6+SEX+EDUCATION+
MARRIAGE,
family=binomial(link="logit"),data=a_train)
summary(logit.class)
par(mfrow=c(2,2))
plot(logit.class)
logit<-predict.glm(logit.class,a_valid)
odds<-exp(logit)
head(odds)
View(a_valid)
head(odds)
probability<-predict.glm(logit.class,a_valid,type="response")
head(probability)
coefficients(logit.class)[1]
p <-ifelse(logit.class$fitted.values >= 0.5,0,1)
table(p, a_train$default.payment.next.month)
pr<-ifelse(probability <= 0.3,0,1)
library(e1071)
confusionMatrix(factor(a_valid[,25]),factor(pr))
library(ROCR)
rocChart(pr,a_valid[,25])
knn.1 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 1,prob = TRUE)
table(knn.1,defualtvalid)
library(kknn)
library(class)
knn.1 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 1,prob = TRUE)
table(knn.1,defualtvalid)
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(RColorBrewer)
library(gmodels)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\TrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\ValidationSet.csv")
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\TrainingSet.csv")
sum(is.na(a_train))
#change the numerical to factor
n_train$SEX<-as.factor(n_train$SEX)
n_train$EDUCATION<-as.factor(n_train$EDUCATION)
n_train$MARRIAGE<-as.factor(n_train$MARRIAGE)
n_valid$SEX<-as.factor(n_valid$SEX)
n_valid$EDUCATION<-as.factor(n_valid$EDUCATION)
n_valid$MARRIAGE<-as.factor(n_valid$MARRIAGE)
#creating dummy variables for sex,education and marriage
dummy_cat<-fastDummies::dummy_cols(n_train[3:5])
head(dummy_cat[4:13])
dummy_cat_v<-fastDummies::dummy_cols(n_valid[3:5])
head(dummy_cat_v[4:13])
#adding the dummies to the dataframe and removing orginal
#and creating a new df with dummies(wd)
n_train_wd<-cbind(n_train[-3:-5],dummy_cat[4:13])
View(n_train_wd)
n_valid_wd<-cbind(n_valid[-3:-5],dummy_cat_v[4:13])
View(n_valid_wd)
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\TrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\ValidationSet.csv")
View(a_train)
sum(is.na(a_train))
n_train = as.data.frame(scale(a_train[,-25]))
n_valid = as.data.frame(scale(a_valid[,-25]))
#change the numerical to factor
n_train$SEX<-as.factor(n_train$SEX)
n_train$EDUCATION<-as.factor(n_train$EDUCATION)
n_train$MARRIAGE<-as.factor(n_train$MARRIAGE)
n_valid$SEX<-as.factor(n_valid$SEX)
n_valid$EDUCATION<-as.factor(n_valid$EDUCATION)
n_valid$MARRIAGE<-as.factor(n_valid$MARRIAGE)
#creating dummy variables for sex,education and marriage
dummy_cat<-fastDummies::dummy_cols(n_train[3:5])
head(dummy_cat[4:13])
dummy_cat_v<-fastDummies::dummy_cols(n_valid[3:5])
head(dummy_cat_v[4:13])
#adding the dummies to the dataframe and removing orginal
#and creating a new df with dummies(wd)
n_train_wd<-cbind(n_train[-3:-5],dummy_cat[4:13])
n_valid_wd<-cbind(n_valid[-3:-5],dummy_cat_v[4:13])
defualttrain <- a_train$default.payment.next.month
defualtvalid<- a_valid$default.payment.next.month
library(kknn)
library(class)
knn.1 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 1,prob = TRUE)
table(knn.1,defualtvalid)
knn.1
confusionMatrix(factor(knn.1),factor(defualtvalid))
knn.5 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 5,prob = TRUE)
confusionMatrix(factor(knn.5),factor(defualtvalid))
knn.2 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 2,prob = TRUE)
confusionMatrix(factor(knn.2),factor(defualtvalid))
knn.5 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 5,prob = TRUE)
confusionMatrix(factor(knn.5),factor(defualtvalid))
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogTrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogValidationSet.csv")
sum(is.na(a_train))
#change the numerical to factor
a_train$SEX<-as.factor(a_train$SEX)
a_train$EDUCATION<-as.factor(a_train$EDUCATION)
a_train$MARRIAGE<-as.factor(a_train$MARRIAGE)
a_valid$SEX<-as.factor(a_valid$SEX)
a_valid$EDUCATION<-as.factor(a_valid$EDUCATION)
a_valid$MARRIAGE<-as.factor(a_valid$MARRIAGE)
#creating dummy variables for sex,education and marriage
dummy_cat<-fastDummies::dummy_cols(a_train[3:5])
head(dummy_cat[4:13])
dummy_cat_v<-fastDummies::dummy_cols(a_valid[3:5])
head(dummy_cat_v[4:13])
#adding the dummies to the dataframe and removing orginal
#and creating a new df with dummies(wd)
a_train_wd<-cbind(a_train[-3:-5],dummy_cat[4:13])
a_valid_wd<-cbind(a_valid[-3:-5],dummy_cat_v[4:13])
library(C50)
#running a regression tree
set.seed(123)
RT1<-rpart(default.payment.next.month ~ LIMIT_BAL+AGE+PAY_0+PAY_2+PAY_3+
PAY_4+PAY_5+PAY_6+PAY_AMT1+PAY_AMT2+PAY_AMT3+PAY_AMT4+PAY_AMT5+
PAY_AMT6+SEX_2+SEX_1+EDUCATION_2+EDUCATION_1+EDUCATION_3+
EDUCATION_4+EDUCATION_0+MARRIAGE_1+MARRIAGE_2+MARRIAGE_3,
data = a_train_wd,
method="anova",control = rpart.control(maxdepth = 3))
summary(RT1)
prp(RT1, type = 1, extra = 1, split.font = 1, varlen = -10)
plotcp(RT1)
summary(RT1)
plotcp(RT1)
par(mfrow = c(1,1))
RT1.pred<-predict(RT1,a_train_wd,type="vector")
prp(RT1, type = 1, extra = 1, split.font = 1, varlen = -10)
plotcp(RT1)
par(mfrow = c(1,1))
RT1.pred<-predict(RT1,a_train_wd,type="vector")
RT1.valid<-predict(RT1,a_valid_wd,type="vector")
RMSE(RT1.pred,a_train_wd$default.payment.next.month)
RMSE(RT1.valid,a_valid_wd$default.payment.next.month)
library(e1071)
View(a_valid_wd[22])
confusionMatrix(factor(a_valid_wd[,22]),factor(pr))
confusionMatrix(factor(a_valid_wd[,22]),factor(RT1.valid))
pr<-ifelse(RT1.valid >= 0.3,1,0)
confusionMatrix(factor(a_valid_wd[,22]),factor(pr))
par(mfrow=c(1,2))
boxplot(RT1.pred-a_train_wd$default.payment.next.month,main="Boxplot for training data error")
boxplot(RT1.pred-a_train_wd$default.payment.next.month,main="Boxplot for training data error")
boxplot(RT1.valid-a_valid_wd$default.payment.next.month,main="Boxplot for validation data error")
par(mfrow=c(1,1))
RT1.cv<-rpart(default.payment.next.month ~ LIMIT_BAL+AGE+PAY_0+PAY_2+PAY_3+
PAY_4+PAY_5+PAY_6+PAY_AMT1+PAY_AMT2+PAY_AMT3+PAY_AMT4+PAY_AMT5+
PAY_AMT6+SEX_2+SEX_1+EDUCATION_2+EDUCATION_1+EDUCATION_3+
EDUCATION_4+EDUCATION_0+MARRIAGE_1+MARRIAGE_2+MARRIAGE_3,
data=a_train_wd,method="anova",cp=0.00001,minsplit=2,xval=5)
printcp(RT1.cv)
RT1.pruned<-prune(RT1.cv, cp = RT1.cv$cptable[which.min(RT1.cv$cptable[,"xerror"]),"CP"])
prp(RT1.pruned, type = 1, extra = 1, split.font = 1, varlen = -10)
pruned.valid<-predict(RT1.pruned,a_train_wd,type="vector")
RMSE(pruned.valid,a_valid_wd$default.payment.next.month)
pr<-ifelse(RT1.pruned >= 0.3,1,0)
pr<-ifelse(pruned.valid >= 0.3,1,0)
confusionMatrix(factor(a_valid_wd[,22]),factor(pr))
length(pruned.valid)
pruned.valid<-predict(RT1.pruned,a_valid_wd,type="vector")
RMSE(pruned.valid,a_valid_wd$default.payment.next.month)
length(pruned.valid)
pr<-ifelse(pruned.valid >= 0.3,1,0)
confusionMatrix(factor(a_valid_wd[,22]),factor(pr))
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogTrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogValidationSet.csv")
#change the numerical to factor
a_train$SEX<-as.factor(a_train$SEX)
a_train$EDUCATION<-as.factor(a_train$EDUCATION)
a_train$MARRIAGE<-as.factor(a_train$MARRIAGE)
a_valid$SEX<-as.factor(a_valid$SEX)
a_valid$EDUCATION<-as.factor(a_valid$EDUCATION)
a_valid$MARRIAGE<-as.factor(a_valid$MARRIAGE)
logit.class<-glm(default.payment.next.month ~LIMIT_BAL+AGE+PAY_0+PAY_2+PAY_3+
PAY_4+PAY_5+PAY_6+PAY_AMT1+PAY_AMT2+PAY_AMT3+PAY_AMT4+PAY_AMT5+
PAY_AMT6+SEX+EDUCATION+
MARRIAGE,
family=binomial(link="logit"),data=a_train)
summary(logit.class)
par(mfrow=c(2,2))
plot(logit.class)
logit<-predict.glm(logit.class,a_valid)
odds<-exp(logit)
head(odds)
probability<-predict.glm(logit.class,a_valid,type="response")
head(probability)
coefficients(logit.class)[1]
p <-ifelse(logit.class$fitted.values >= 0.5,0,1)
table(p, a_train$default.payment.next.month)
p <-ifelse(logit.class$fitted.values >= 0.9,0,1)
table(p, a_train$default.payment.next.month)
p <-ifelse(logit.class$fitted.values >= 0.1,0,1)
p <-ifelse(logit.class$fitted.values >= 0,0,1)
p <-ifelse(logit.class$fitted.values >= 0.03,0,1)
View(a_valid)
pr<-ifelse(probability <= 0.3,0,1)
library(e1071)
confusionMatrix(factor(a_valid[,25]),factor(pr))
library(ROCR)
rocChart(pr,a_valid[,25])
abline(0,0)
abline(0,1)
abline(0,1,1,1)
line(0,1,1,1)
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\TrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\ValidationSet.csv")
sum(is.na(a_train))
n_train = as.data.frame(scale(a_train[,-25]))
n_valid = as.data.frame(scale(a_valid[,-25]))
#change the numerical to factor
n_train$SEX<-as.factor(n_train$SEX)
n_train$EDUCATION<-as.factor(n_train$EDUCATION)
n_train$MARRIAGE<-as.factor(n_train$MARRIAGE)
n_valid$SEX<-as.factor(n_valid$SEX)
n_valid$EDUCATION<-as.factor(n_valid$EDUCATION)
n_valid$MARRIAGE<-as.factor(n_valid$MARRIAGE)
#creating dummy variables for sex,education and marriage
dummy_cat<-fastDummies::dummy_cols(n_train[3:5])
head(dummy_cat[4:13])
dummy_cat_v<-fastDummies::dummy_cols(n_valid[3:5])
head(dummy_cat_v[4:13])
#adding the dummies to the dataframe and removing orginal
#and creating a new df with dummies(wd)
n_train_wd<-cbind(n_train[-3:-5],dummy_cat[4:13])
n_valid_wd<-cbind(n_valid[-3:-5],dummy_cat_v[4:13])
defualttrain <- a_train$default.payment.next.month
defualtvalid<- a_valid$default.payment.next.month
library(kknn)
library(class)
knn.1 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 1,prob = TRUE)
table(knn.1,defualtvalid)
confusionMatrix(factor(knn.1),factor(defualtvalid))
knn.2 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 2,prob = TRUE)
confusionMatrix(factor(knn.2),factor(defualtvalid))
knn.3 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 3,prob = TRUE)
confusionMatrix(factor(knn.3),factor(defualtvalid))
knn.4 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 4,prob = TRUE)
confusionMatrix(factor(knn.4),factor(defualtvalid))
knn.5 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 5,prob = TRUE)
confusionMatrix(factor(knn.5),factor(defualtvalid))
library(ROCR)
rocChart(knn.5,a_valid[,25])
knn.5
a_valid-,25
a_valid[,25]
library(ROCR)
rocChart(knn.5,a_valid[,25])
list(knn.5)
rocChart(list(knn.5),a_valid[,25])
rocChart(factor(knn.5),factor(a_valid[,25]))
rocChart(numeric(knn.5),numeric(a_valid[,25]))
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogTrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogValidationSet.csv")
View(a_train)
sum(is.na(a_train))
#change the numerical to factor
a_train$SEX<-as.factor(a_train$SEX)
a_train$EDUCATION<-as.factor(a_train$EDUCATION)
a_train$MARRIAGE<-as.factor(a_train$MARRIAGE)
a_valid$SEX<-as.factor(a_valid$SEX)
a_valid$EDUCATION<-as.factor(a_valid$EDUCATION)
a_valid$MARRIAGE<-as.factor(a_valid$MARRIAGE)
#creating dummy variables for sex,education and marriage
dummy_cat<-fastDummies::dummy_cols(a_train[3:5])
head(dummy_cat[4:13])
dummy_cat_v<-fastDummies::dummy_cols(a_valid[3:5])
head(dummy_cat_v[4:13])
#adding the dummies to the dataframe and removing orginal
#and creating a new df with dummies(wd)
a_train_wd<-cbind(a_train[-3:-5],dummy_cat[4:13])
View(a_train_wd)
a_valid_wd<-cbind(a_valid[-3:-5],dummy_cat_v[4:13])
View(a_valid_wd)
library(C50)
#running a regression tree
set.seed(123)
colnames(a_train_wd)
RT1<-rpart(default.payment.next.month ~ LIMIT_BAL+AGE+PAY_0+PAY_2+PAY_3+
PAY_4+PAY_5+PAY_6+PAY_AMT1+PAY_AMT2+PAY_AMT3+PAY_AMT4+PAY_AMT5+
PAY_AMT6+SEX_2+SEX_1+EDUCATION_2+EDUCATION_1+EDUCATION_3+
EDUCATION_4+EDUCATION_0+MARRIAGE_1+MARRIAGE_2+MARRIAGE_3,
data = a_train_wd,
method="anova",control = rpart.control(maxdepth = 3))
print(RT1)
summary(RT1)
prp(RT1, type = 1, extra = 1, split.font = 1, varlen = -10)
plotcp(RT1)
par(mfrow = c(1,1))
RT1.pred<-predict(RT1,a_train_wd,type="vector")
RT1.valid<-predict(RT1,a_valid_wd,type="vector")
RMSE(RT1.pred,a_train_wd$default.payment.next.month)
RMSE(RT1.valid,a_valid_wd$default.payment.next.month)
library(e1071)
View(a_valid_wd[22])
pr<-ifelse(RT1.valid >= 0.3,1,0)
confusionMatrix(factor(a_valid_wd[,22]),factor(pr))
library(ROCR)
rocChart(pr,a_valid[,25])
RT1.cv<-rpart(default.payment.next.month ~ LIMIT_BAL+AGE+PAY_0+PAY_2+PAY_3+
PAY_4+PAY_5+PAY_6+PAY_AMT1+PAY_AMT2+PAY_AMT3+PAY_AMT4+PAY_AMT5+
PAY_AMT6+SEX_2+SEX_1+EDUCATION_2+EDUCATION_1+EDUCATION_3+
EDUCATION_4+EDUCATION_0+MARRIAGE_1+MARRIAGE_2+MARRIAGE_3,
data=a_train_wd,method="anova",cp=0.00001,minsplit=2,xval=5)
printcp(RT1.cv)
RT1.pruned<-prune(RT1.cv, cp = RT1.cv$cptable[which.min(RT1.cv$cptable[,"xerror"]),"CP"])
prp(RT1.pruned, type = 1, extra = 1, split.font = 1, varlen = -10)
pruned.valid<-predict(RT1.pruned,a_valid_wd,type="vector")
RMSE(pruned.valid,a_valid_wd$default.payment.next.month)
length(pruned.valid)
pr<-ifelse(pruned.valid >= 0.3,1,0)
confusionMatrix(factor(a_valid_wd[,22]),factor(pr))
library(ROCR)
rocChart(pr,a_valid[,25])
library(ROCR)
rocChart(numeric(knn.5),numeric(a_valid[,25]))
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\TrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\ValidationSet.csv")
sum(is.na(a_train))
n_train = as.data.frame(scale(a_train[,-25]))
n_valid = as.data.frame(scale(a_valid[,-25]))
#change the numerical to factor
n_train$SEX<-as.factor(n_train$SEX)
n_train$EDUCATION<-as.factor(n_train$EDUCATION)
n_train$MARRIAGE<-as.factor(n_train$MARRIAGE)
n_valid$SEX<-as.factor(n_valid$SEX)
n_valid$EDUCATION<-as.factor(n_valid$EDUCATION)
n_valid$MARRIAGE<-as.factor(n_valid$MARRIAGE)
#creating dummy variables for sex,education and marriage
dummy_cat<-fastDummies::dummy_cols(n_train[3:5])
head(dummy_cat[4:13])
dummy_cat_v<-fastDummies::dummy_cols(n_valid[3:5])
head(dummy_cat_v[4:13])
#adding the dummies to the dataframe and removing orginal
#and creating a new df with dummies(wd)
n_train_wd<-cbind(n_train[-3:-5],dummy_cat[4:13])
n_valid_wd<-cbind(n_valid[-3:-5],dummy_cat_v[4:13])
defualttrain <- a_train$default.payment.next.month
defualtvalid<- a_valid$default.payment.next.month
library(kknn)
library(class)
knn.1 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 1,prob = TRUE)
table(knn.1,defualtvalid)
confusionMatrix(factor(knn.1),factor(defualtvalid))
knn.2 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 2,prob = TRUE)
confusionMatrix(factor(knn.2),factor(defualtvalid))
knn.3 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 3,prob = TRUE)
confusionMatrix(factor(knn.3),factor(defualtvalid))
knn.4 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 4,prob = TRUE)
confusionMatrix(factor(knn.4),factor(defualtvalid))
knn.5 = knn(n_train_wd,n_valid_wd,cl = defualttrain,k= 5,prob = TRUE)
confusionMatrix(factor(knn.5),factor(defualtvalid))
library(ROCR)
rocChart(numeric(knn.5),numeric(a_valid[,25]))
rocChart(numeric(knn.5),numeric(a_valid[,25]))
library(caret)
library(lattice)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(rattle)
library(tree)
library(gmodels)
library(RColorBrewer)
#loding the data and viewing.
a_train<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogTrainingSet.csv")
a_valid<-read.csv("C:\\Users\\ashwi\\Desktop\\Project\\LogValidationSet.csv")
#change the numerical to factor
a_train$SEX<-as.factor(a_train$SEX)
a_train$EDUCATION<-as.factor(a_train$EDUCATION)
a_train$MARRIAGE<-as.factor(a_train$MARRIAGE)
a_valid$SEX<-as.factor(a_valid$SEX)
a_valid$EDUCATION<-as.factor(a_valid$EDUCATION)
a_valid$MARRIAGE<-as.factor(a_valid$MARRIAGE)
logit.class<-glm(default.payment.next.month ~LIMIT_BAL+AGE+PAY_0+PAY_2+PAY_3+
PAY_4+PAY_5+PAY_6+PAY_AMT1+PAY_AMT2+PAY_AMT3+PAY_AMT4+PAY_AMT5+
PAY_AMT6+SEX+EDUCATION+
MARRIAGE,
family=binomial(link="logit"),data=a_train)
summary(logit.class)
logit.class<-glm(default.payment.next.month ~ LIMIT_BAL+PAY_0+PAY_2+PAY_3+PAY_6+PAY_AMT3+MARRIAGE2,family=binomial(link="logit"),data=a_train)
logit.class<-glm(default.payment.next.month ~ LIMIT_BAL+PAY_0+PAY_2+PAY_3+PAY_6+PAY_AMT3+MARRIAGE,family=binomial(link="logit"),data=a_train)
summary(logit.class)
logit<-predict.glm(logit.class,a_valid)
odds<-exp(logit)
head(odds)
probability<-predict.glm(logit.class,a_valid,type="response")
head(probability)
coefficients(logit.class)[1]
p <-ifelse(logit.class$fitted.values >= 0.5,0,1)
table(p, a_train$default.payment.next.month)
p <-ifelse(logit.class$fitted.values >= 0.9,0,1)
pr<-ifelse(probability <= 0.3,0,1)
library(e1071)
confusionMatrix(factor(a_valid[,25]),factor(pr))
